
undefined4 FUN_00009258(void)

{
  bool bVar1;
  int iVar2;
  FILE *pFVar3;
  size_t __n;
  undefined4 local_13c;
  undefined *local_9c;
  ulong local_18;
  ulong uStack4;
  
  uStack4 = 0x9264;
  local_9c = &LAB_00009208;
  sigemptyset((sigset_t *)&stack0xffffff68);
  local_18 = 0x20000000;
  iVar2 = sigaction(0xe,(sigaction *)&local_9c,(sigaction *)&stack0xfffffed8);
  if (iVar2 < 0) {
    local_13c = 0xffffffff;
  }
  else {
    bVar1 = false;
    iVar2 = system("/usr/bin/test-web-login.sh");
    DAT_000122bc = 0;
    if (iVar2 != 0) {
      fprintf(stdout,"\nAnother session in WEB mode is already running!!!");
      fprintf(stdout,"\nEDIT mode is not available.");
      fprintf(stdout,"\npress any key to continue...\n");
      FUN_00008ae0();
      if (__stdin->_lock == (_IO_lock_t *)0x0) {
        fgetc(__stdin);
      }
      else {
        if (__stdin->_IO_write_base < __stdin->_IO_write_end) {
          __stdin->_IO_write_base = __stdin->_IO_write_base + 1;
        }
        else {
          __fgetc_unlocked(__stdin);
        }
      }
      FUN_00008ba8();
    }
    system("./editmode_test_crashed.sh");
    pFVar3 = fopen("/var/run/cli_editmode.lock","r");
    if (pFVar3 != (FILE *)0x0) {
      fclose(pFVar3);
      bVar1 = true;
      fprintf(stdout,"\nAnother CLI in EDIT mode is already running!!!");
      fprintf(stdout,"\nEDIT mode is not available.");
      fprintf(stdout,"\npress any key to continue...\n");
      FUN_00008ae0();
      if (__stdin->_lock == (_IO_lock_t *)0x0) {
        fgetc(__stdin);
      }
      else {
        if (__stdin->_IO_write_base < __stdin->_IO_write_end) {
          __stdin->_IO_write_base = __stdin->_IO_write_base + 1;
        }
        else {
          __fgetc_unlocked(__stdin);
        }
      }
      FUN_00008ba8();
    }
    if ((!bVar1) && (iVar2 == 0)) {
      pFVar3 = fopen("/var/run/cli_editmode.lock","w");
      if (pFVar3 != (FILE *)0x0) {
        fclose(pFVar3);
      }
      alarm(10);
      fprintf(stdout,"\nPassword:\n");
      FUN_00008b6c();
      read(0,&DAT_00012314,0x14);
      if (DAT_000122bc == 0) {
        __n = strlen(&DAT_000123e8);
        iVar2 = strncmp(&DAT_00012314,&DAT_000123e8,__n);
        if ((iVar2 == 0) && (DAT_000122b8 == '\x01')) {
          alarm(0);
          FUN_00008b30();
          system("clear");
          FUN_00008d5c();
          fprintf(stdout,"  EDIT MODE\n");
          fprintf(stdout," -----------\n");
          fprintf(stdout,"\n twice tab - list of commands");
          fprintf(stdout,"\n x - leave current mode\n");
          fprintf(stdout," -------------------------------------\n\n\n");
          FUN_00008b30();
          system("./edit.sh");
          iVar2 = remove("/var/run/cli_editmode.lock");
          if (iVar2 != 0) {
            fprintf(stdout,
                    "\nPANIC:You need to reboot the %s in order to save the consistency of router settings!!!\n"
                    ,&DAT_00012368);
            perror("/var/run/cli_editmode.lock");
            sleep(5);
          }
        }
        else {
          alarm(0);
          iVar2 = remove("/var/run/cli_editmode.lock");
          if (iVar2 != 0) {
            fprintf(stdout,
                    "\nPANIC:You need to reboot the %s in order to save the consistency of router settings!!!\n"
                    ,&DAT_00012368);
            perror("/var/run/cli_editmode.lock");
            sleep(5);
          }
          fprintf(stdout,"\nInvalid password for EDIT mode!!!\n");
          sleep(2);
        }
      }
      else {
        iVar2 = remove("/var/run/cli_editmode.lock");
        if (iVar2 != 0) {
          fprintf(stdout,
                  "\nPANIC:You need to reboot the %s in order to save the consistency of router settings!!!\n"
                  ,&DAT_00012368);
          perror("/var/run/cli_editmode.lock");
          sleep(5);
        }
      }
    }
  }
  return local_13c;
}

